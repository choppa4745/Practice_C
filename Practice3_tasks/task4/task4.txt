1Ô∏è‚É£ –°–∫–æ–º–ø–∏–ª–∏—Ä—É–π –ø–æ—ç—Ç–∞–ø–Ω–æ:
gcc -c file1.c file2.c main.c
2Ô∏è‚É£ –ò—Å—Å–ª–µ–¥—É–π —Ç–∞–±–ª–∏—Ü—É —Å–∏–º–≤–æ–ª–æ–≤ —á–µ—Ä–µ–∑ nm:

nm file1.o
nm file2.o
nm main.o

–ß—Ç–æ –º—ã –≤–∏–¥–∏–º?
 D _global_var
0000000000000000 T _print_from_file1
                 U _printf
000000000000005c d _static_var
0000000000000060 s l_.str
000000000000007c s l_.str.1
0000000000000000 t ltmp0
0000000000000058 d ltmp1
0000000000000060 s ltmp2
0000000000000098 s ltmp3

–ö–∞–∫–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –µ—Å—Ç—å? –í–∏–¥–Ω–∞ –ª–∏ static_var –≤ file1.o? –ï—Å—Ç—å –ª–∏ global_var –≤ –¥–≤—É—Ö .o?

global_var: –ì–ª–æ–±–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è, –≤–∏–¥–Ω–∞ –≤ –¥—Ä—É–≥–∏—Ö —Ñ–∞–π–ª–∞—Ö (—Å–∏–º–≤–æ–ª D ‚Äî –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Å–µ–∫—Ü–∏–∏ .data).
static_var: –°—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è, –≤–∏–¥–Ω–∞ —Ç–æ–ª—å–∫–æ –≤ file1.c (—Å–∏–º–≤–æ–ª d ‚Äî –ª–æ–∫–∞–ª—å–Ω—ã–π —Å–∏–º–≤–æ–ª –≤ —Å–µ–∫—Ü–∏–∏ .data).
print_from_file1: –§—É–Ω–∫—Ü–∏—è, –≤–∏–¥–Ω–∞ –≤ –¥—Ä—É–≥–∏—Ö —Ñ–∞–π–ª–∞—Ö (—Å–∏–º–≤–æ–ª T ‚Äî –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Å–µ–∫—Ü–∏–∏ .text).


3Ô∏è‚É£ –ü–æ–ø—Ä–æ–±—É–π —Å–æ–±—Ä–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É:
gcc file1.o file2.o main.o -o program
–ü–æ–ª—É—á–∞–µ—à—å –ª–∏ **–æ—à–∏–±–∫—É –ª–∏–Ω–∫–æ–≤–∫–∏** –∏–∑-–∑–∞ global_var?

gcc file1.o file2.o main.o -o program
ld: Undefined symbols:
  _static_var, referenced from:
      _print_from_file2 in file2.o
clang: error: linker command failed with exit code 1 (use -v to see invocation)

4Ô∏è‚É£ –ò—Å–ø—Ä–∞–≤—å –∫–æ–¥:
–£–¥–∞–ª–∏ –¥—É–±–ª–∏—Ä—É—é—â–∏–π—Å—è global_var = 30; –≤ file2.c
–£–¥–∞–ª–∏ extern int static_var;
–ü–µ—Ä–µ–∫–æ–º–ø–∏–ª–∏—Ä—É–π –∏ —Å–Ω–æ–≤–∞ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π nm.
5Ô∏è‚É£ –ü–æ—Å–º–æ—Ç—Ä–∏, –≥–¥–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ –ø–∞–º—è—Ç–∏:

objdump -t file1.o

file1.o:        file format mach-o arm64

SYMBOL TABLE:
0000000000000000 l     F __TEXT,__text ltmp0
0000000000000060 l     O __TEXT,__cstring l_.str
000000000000005c l     O __DATA,__data _static_var
000000000000007c l     O __TEXT,__cstring l_.str.1
0000000000000058 l     O __DATA,__data ltmp1
0000000000000060 l     O __TEXT,__cstring ltmp2
0000000000000098 l     O __LD,__compact_unwind ltmp3
0000000000000058 g     O __DATA,__data _global_var
0000000000000000 g     F __TEXT,__text _print_from_file1
0000000000000000         *UND* _printf


objdump -t file2.o

file2.o:        file format mach-o arm64

SYMBOL TABLE:
0000000000000000 l     F __TEXT,__text ltmp0
000000000000003c l     O __TEXT,__cstring l_.str
000000000000003c l     O __TEXT,__cstring ltmp1
0000000000000058 l     O __LD,__compact_unwind ltmp2
0000000000000000 g     F __TEXT,__text _print_from_file2
0000000000000000         *UND* _global_var
0000000000000000         *UND* _printf


objdump -t main.o

SYMBOL TABLE:
0000000000000000 l     F __TEXT,__text ltmp0
0000000000000054 l     O __TEXT,__cstring l_.str
0000000000000054 l     O __TEXT,__cstring ltmp1
0000000000000070 l     O __LD,__compact_unwind ltmp2
0000000000000000 g     F __TEXT,__text _main
0000000000000000         *UND* _global_var
0000000000000000         *UND* _print_from_file1
0000000000000000         *UND* _print_from_file2
0000000000000000         *UND* _printf

–í –∫–∞–∫–æ–º —Å–µ–≥–º–µ–Ω—Ç–µ –ø–∞–º—è—Ç–∏: .bss, .data, .text?

6Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä—å —Å—Ç—Ä–æ–∫–∏ –≤ –±–∏–Ω–∞—Ä–Ω–∏–∫–µ:
strings program

file1.c -> global_var = %d
file1.c -> static_var = %d
file2.c -> global_var = %d
main.c -> global_var = %d

–í–∏–¥–Ω—ã –ª–∏ —Å—Ç—Ä–æ–∫–∏ –∏–∑ printf()?

üîπ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —à–∞–≥–∏
–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω–∏:

objdump -x program
–ü—Ä–æ–≤–µ—Ä—å —Ç–∞–±–ª–∏—Ü—É —Å–∏–º–≤–æ–ª–æ–≤ –ø–æ—Å–ª–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–π –∫–æ–º–ø–∏–ª—è—Ü–∏–∏:

gcc -static file1.c file2.c main.c
üîπ –ß—Ç–æ —Å–º–æ—Ç—Ä–µ—Ç—å?
Entry point ‚Äî —Å –∫–∞–∫–æ–≥–æ –∞–¥—Ä–µ—Å–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã.
–†–∞–∑–¥–µ–ª—ã –ø–∞–º—è—Ç–∏ ‚Äî .text, .data, .bss, .rodata.
–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ - (NEEDED) ‚Äî –∫–∞–∫–∏–µ .so –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏.
üí° –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –≤–æ–ø—Ä–æ—Å:
üëâ –ü–æ—á–µ–º—É global_var –µ—Å—Ç—å –≤ .data, –∞ static_var –Ω–µ—Ç –≤ —Ç–∞–±–ª–∏—Ü–µ —Å–∏–º–≤–æ–ª–æ–≤?

global_var: –ì–ª–æ–±–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è, –≤–∏–¥–∏–º–∞—è –≤ –¥—Ä—É–≥–∏—Ö —Ñ–∞–π–ª–∞—Ö, –ø–æ—ç—Ç–æ–º—É –æ–Ω–∞ –ø–æ–ø–∞–¥–∞–µ—Ç –≤ —Ç–∞–±–ª–∏—Ü—É —Å–∏–º–≤–æ–ª–æ–≤.
static_var: –°—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è, –≤–∏–¥–∏–º–∞—è —Ç–æ–ª—å–∫–æ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö file1.c. –û–Ω–∞ –Ω–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü—É —Å–∏–º–≤–æ–ª–æ–≤ –¥–ª—è –ª–∏–Ω–∫–æ–≤–∫–∏, –Ω–æ –≤—Å—ë –µ—â—ë –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Å–µ–∫—Ü–∏–∏ .data.